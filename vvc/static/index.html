<!doctype html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>VVC</title>
    </head>

    <body>
        <script src="index.js"></script>
        <div class="main-box" id="main-box">
            <div class="vert-flex">
                <div id="codemirror-holder"></div>
                <p id="output"></p>
            </div>

            <div class="vert-flex btn-group">
                <button type="button" id="show_manual">
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="16"
                        height="16"
                        fill="currentColor"
                        class="bi bi-book"
                        viewBox="0 0 16 16"
                    >
                        <path
                            d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783"
                        />
                    </svg>
                    MANUAL
                </button>
                <div class="vert-spacer"></div>
                <button type="button" id="full_reload">
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="16"
                        height="16"
                        fill="currentColor"
                        class="bi bi-arrow-counterclockwise"
                        viewBox="0 0 16 16"
                    >
                        <path
                            fill-rule="evenodd"
                            d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2z"
                        />
                        <path
                            d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466"
                        />
                    </svg>
                    FULL RELOAD
                </button>
                <button type="button" id="hot_reload">
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="16"
                        height="16"
                        fill="currentColor"
                        class="bi bi-fire"
                        viewBox="0 0 16 16"
                    >
                        <path
                            d="M8 16c3.314 0 6-2 6-5.5 0-1.5-.5-4-2.5-6 .25 1.5-1.25 2-1.25 2C11 4 9 .5 6 0c.357 2 .5 4-2 6-1.25 1-2 2.729-2 4.5C2 14 4.686 16 8 16m0-1c-1.657 0-3-1-3-2.75 0-.75.25-2 1.25-3C6.125 10 7 10.5 7 10.5c-.375-1.25.5-3.25 2-3.5-.179 1-.25 2 1 3 .625.5 1 1.364 1 2.25C11 14 9.657 15 8 15"
                        />
                    </svg>
                    HOT RELOAD
                </button>
                <button type="button" id="check_source_code">
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="16"
                        height="16"
                        fill="currentColor"
                        class="bi bi-check-lg"
                        viewBox="0 0 16 16"
                    >
                        <path
                            d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.88 12.01a.733.733 0 0 1-1.065.02L3.217 8.384a.757.757 0 0 1 0-1.06.733.733 0 0 1 1.047 0l3.052 3.093 5.4-6.425z"
                        />
                    </svg>
                    CHECK CODE
                </button>
                <div class="vert-spacer"></div>
                <button type="button" id="reset_code">
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="16"
                        height="16"
                        fill="currentColor"
                        class="bi bi-trash"
                        viewBox="0 0 16 16"
                    >
                        <path
                            d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"
                        />
                        <path
                            d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"
                        />
                    </svg>
                    RESET CODE
                </button>
            </div>

            <div id="game-container">
                <div class="loader">
                    <div class="lds-dual-ring"></div>
                    <div class="loading-text">Loading...</div>
                </div>
            </div>
        </div>
        <dialog id="manual-dialog">
            <form method="dialog">
                <button>
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="16"
                        height="16"
                        fill="currentColor"
                        class="bi bi-x-lg"
                        viewBox="0 0 16 16"
                    >
                        <path
                            d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z"
                        />
                    </svg>
                    CLOSE
                </button>
            </form>
            <h1>VVC Manual</h1>
            <h2>Overview</h2>
            <p>
                VVC is a
                <a
                    href="https://en.wikipedia.org/wiki/Fantasy_video_game_console"
                    >Fantasy Video Game Console</a
                >.
            </p>
            <p>
                It features a custom scripting language, that is functional,
                declarative, statically typed and interpreted.
            </p>
            <p>
                The limitation of this console is that it can only draw
                <a href="https://en.wikipedia.org/wiki/Vector_graphics"
                    >vector graphics</a
                >
                (currently only lines, maybe more to come).
            </p>
            <h2>Language</h2>
            <p>
                As mentioned, the scripting language is a custom one. It's
                inspired by
                <a href="https://elm-lang.org/">Elm</a>,
                <a href="https://www.roc-lang.org/">Roc</a> and
                <a
                    href="https://nixos.org/manual/nix/stable/language/index.html"
                    >Nix</a
                >.
                <br />
            </p>
            <p>It's features include:</p>

            <ul>
                <li>functional and pure</li>
                <li>declarative</li>
                <li>statically typed</li>
                <li>tagged unions</li>
                <li>no side-effects</li>
                <li>hot-reloadable</li>
                <li>interpreted</li>
                <li>curry-ing by default</li>
            </ul>
            <p>
                Syntax is mostly similar to Rust, but there are some
                differences.
            </p>
            <h3>Basic concepts</h3>
            <h4>Expressions</h4>
            <p>
                Everything is an expression. Since you can't have side-effects
                or mutation, things only matter if they are assigned to
                something.
            </p>
            <p>
                Because of that, everything evaluates to something. Functions
                must return something, all branches must return the same value,
                etc.
            </p>
            <h4>Definitions</h4>
            <p>
                Definitions are just assigning an expression to a name. For
                example:
                <br />
                <span class="term">x = 5;</span>
                <br />
                This will assign
                <span class="term">5</span> to <span class="term">x</span>;
            </p>
            <p>All definitions need to end with a semicolon.</p>
            <p>You can't redefine/shadow definitions!</p>
            <p>
                <b>Note:</b> currently, order of definitions can
                <i>sometimes</i> matter.
                <br />
                This is an interpreter bug and will be fixed one day.
            </p>
            <p><u>A file is just a collection of definitions.</u></p>
            <h4>Basic types</h4>
            <p>
                The most basic types are <span class="term">Int</span>,
                <span class="term">Float</span>
                and
                <span class="term">String</span>. They are what you expect
                (although <span class="term">String</span>s are pretty useless
                for now).
            </p>
            <p>Those types are the building blocks of other types.</p>
            <p>
                Important thing of note is that you can't mix
                <span class="term">Float</span>s and
                <span class="term">Int</span>s. They have separate operators
                (like in OCaml).
            </p>
            <h4>Functions</h4>
            <p>
                You can think of functions as just another type. It's a very
                special type which can be called. When called with all the
                required arguments, it will evaluate to a value.
            </p>
            <p>
                Function definition consists of arguments it takes, return type
                and body. Arguments are names with types, return type is the
                type of the returned value and the body is an expression that
                has arguments in scope and evaluates to a value of the return
                type. Example:
                <br />
                <span class="term">(a: Int, b: Int) -> Int (a+b)</span>
                <br />
                This defines a simple function that just adds two
                <span class="term">Int</span>s. We can assign it to
                <span class="term">add</span>:
                <br />
                <span class="term">add = (a: Int, b: Int) -> Int (a+b);</span>
                <br />
                and then call it:
                <br />
                <span class="term">add(40,2)</span>
                <br />
            </p>
            <h4>Enums and Enum Matching</h4>
            <p>
                Another important "group" of types are
                <span class="term">Enum</span>s.
                <br />
                <span class="term">Enum</span>s here are are a form of
                <a href="https://en.wikipedia.org/wiki/Tagged_union"
                    >tagged unions</a
                >.
                <br />
                This means that
                <span class="term">Enum Variants</span> can be defined to hold a
                value.
            </p>
            <p>
                One example of an
                <span class="term">Enum</span>
                is
                <span class="term">Option</span>.
                <br />
                It has two possible variants:
                <span class="term">None`</span>
                and
                <span class="term">Some` *A</span> (yes, variant names end with
                backticks).
                <br />
                <span class="term">Some`</span> can hold a value of any type
                (that's what <span class="term">*A</span> means here).
                <br />
                They can be used like so:
                <br />
                <span class="term">foo = Option::None`;</span>
                <br />
                <span class="term">bar = Option::Some` 5;</span>
                <br />
            </p>
            <p>
                <span class="term">Bool</span> is also an enum. It has two
                variants, which don't hold values:
                <span class="term">True`</span> and
                <span class="term">False`</span>.
            </p>
            <p>
                Very nice feature that comes with
                <span class="term">Enum</span>s is
                <span class="term">Enum Matching</span>.
                <br />
                It is a subset of pattern matching found in other languages.
                With that, you can have conditional logic, based on the
                <span class="term">Enum Variant</span>.
                <br />
            </p>
            <p>
                Let's see an example:
                <br />
                <span class="term">? bar | Some` v => v; | None` => 5;</span>
                <br />
                We are matching on the value of
                <span class="term">bar</span>. Let's assume
                <span class="term">bar</span> is of type
                <span class="term">Option&lt;Int&gt;</span> (so the
                <span class="term">Some`</span> holds an
                <span class="term">Int</span>, we'll elaborate on that later).
                <br />
                First branch matches
                <span class="term">Variant Some`</span> and returns the value
                inside.
                <br />
                Second branch matches
                <span class="term">Variant None`</span> and returns
                <span class="term">5</span>.
                <br />
                As you can see, both branches return a value of the same type.
            </p>
            <p>
                You can also create a catch-all branch:
                <br />
                <span class="term">| x => {...};</span>
                <br />
                This branch will match any value and
                <span class="term">x</span> will have the value of the
                expression which you were matching on (so in previous example
                that would be the value of
                <span class="term">bar</span>
                ).
            </p>
            <p>
                <span class="term">Enum Matching</span> can be used with
                <span class="term">Bool</span> as if-else-statements.
            </p>
            <p>
                Here's how you can define your own
                <span class="term">Enum</span> type:
                <br />
                <span class="term">PlayerAction : | Jump` | Move` Float;</span>
                <br />
            </p>
            <p>
                Note: currently it's not possible to define
                <span class="term">Enum</span>s that are generic over the value
                they hold.
            </p>
            <h4>Records</h4>
            <p>
                <span class="term">Record</span>s are objects that can hold
                multiple values of different types, which can be accessed by
                name.
                <br />
                <span class="term">user = < name = "John"; age = 42;>;</span>
                <br />
                You can access the member like so:
                <br />
                <span class="term">@user.name</span>
                <br />
                It also works for nested records:
                <br />
                <span class="term">@@player.speed.x</span>
                <br />
                (Yes, you need a
                <span class="term">@</span>
                for every level of access. It's a bit unwieldy, but it's a
                limitation of the current parser. It will be addressed one day.
                )
            </p>
            <p>
                You will also need to define your own
                <span class="term">Record Type</span>s. Here's how it would look
                like for the <span class="term">user</span>:
                <br />
                <span class="term"
                    >User : &lt; name: String, age: Int &gt;;</span
                >
                <br />
            </p>
            <h4>Lists</h4>
            <p>
                Final type on our list (pun intended) is
                <span class="term">List</span>.
                <br />
                Syntax for creating them looks like this:
                <br />
                <span class="term">scores = [1,5,16234];</span>
                <br />
            </p>
            <p>Functions for working with lists are:</p>
            <ul>
                <li>
                    <span class="term"
                        >list_size: (List&lt;*A&gt;) -&gt; Int</span
                    >
                    — for getting the size of the list
                </li>
                <li>
                    <span class="term"
                        >list_get: (List&lt;*A&gt;, Int) -&gt;
                        Option&lt;*A&gt;</span
                    >
                    — for getting an item from the given index
                </li>
                <li>
                    <span class="term"
                        >list_map: (List&lt;*A&gt;, (*A) -&gt; *B) -&gt;
                        List&lt;*B&gt;</span
                    >
                    — for transforming the list with the given function
                </li>
            </ul>
            <h4>Generic Types</h4>
            <p>
                Some of the builtin types are generic over a type. This means
                that their definition doesn't specify what the type of some
                inner value will be. Instead, this will be declared by you or
                inferred from usage.
            </p>
            <p>
                For example, to use a list of integers in a type definition, you
                would do it like this:
                <br />
                <span class="term"
                    >Game : &lt; scores: List&lt;Int&gt; &gt;;</span
                >
                <br />
            </p>
            <p>
                Right now it's not possible to define your own generic types; or
                take or return generic types.
            </p>
            <h2>Game Loop</h2>
            <p>
                The architecture is similar to Elm's "Model-View-Update", but
                view and update are merged.
            </p>
            <p>The game loop looks roughly like this:</p>
            <p>
                When the game starts, the
                <span class="term">Game State</span>
                is initialized to the <span class="term">init</span> value.
            </p>
            <p>
                On every frame <span class="term">update_handler</span> function
                is called. It receives current
                <span class="term">Game State</span>
                and time delta; and returns new
                <span class="term">Game State</span>
                and <span class="term">Commands</span>.
            </p>
            <p>
                When an event happens (such as key being pressed)
                <span class="term">event_handler</span> function is called. It
                receives current
                <span class="term">Game State</span>
                and the
                <span class="term">Event</span>; and returns new
                <span class="term">Game State</span>
                and <span class="term">Commands</span>.
            </p>
            <p>
                <span class="term">Game State</span> can only be modified by
                changing the returned value. Visuals can be only drawn through
                the returned <span class="term">Commands</span>.
            </p>
            <h3>Commands</h3>
            <p>
                <span class="term">Commands</span> are the way of interacting
                with the console.
            </p>
            <p>
                Currently, the only command provided is
                <span class="term">DrawLine</span> command, which draws a
                straight line between two points.
                <br />
                It takes a value of type
                <span class="term">&lt; start: Vec2, end: Vec2 &gt;</span>.
            </p>

            <h3 id="game-state">Game State</h3>
            <h3>Update</h3>
            <h3>Events</h3>
            <h2>Developing Games</h2>
            <p>
                TODO: describe how to make games: writing code, checking code,
                hot/full reloads, sharing code
            </p>
            <form method="dialog">
                <button>
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="16"
                        height="16"
                        fill="currentColor"
                        class="bi bi-x-lg"
                        viewBox="0 0 16 16"
                    >
                        <path
                            d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z"
                        />
                    </svg>
                    CLOSE
                </button>
            </form>
        </dialog>
    </body>
</html>
